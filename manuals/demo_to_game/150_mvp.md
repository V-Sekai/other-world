# MVP with Rigid Body Physics

## Key Features

1. **VR Prototype**: A basic VR environment with one avatar and one chair.
2. **Physics**: The chair behaves as a rigid body, reacting to forces applied by the avatar. It has properties such as position, rotation, velocity, and angular velocity.
3. **Object Interaction**: The avatar can interact with the chair (e.g., sit on it, push it).
4. **Event-Driven**: The system is designed to respond to events (like avatar sitting on the chair) instead of being updated every frame.
5. **State Changes**: The states of the avatar and the chair change based on their interaction.
6. **Mastership vs Ownership**: The master simulates the physics of the objects, while the owner controls the objects' actions.
7. **Networking**: The state changes are sent to the server, then synchronized across all clients.

## Development Steps

1. **Create the VR Environment**: Use Godot to create a simple VR environment with one avatar and one chair.
2. **Upload and Validate Visual Mesh, Colliders, and Skeletons**: Upload the visual mesh, colliders, and skeletons for both the chair and the avatar. Validate these assets to ensure they meet the necessary requirements for the VR environment.
3. **Implement Physics**: Make the chair a rigid body that can react to forces. For example, if the avatar pushes the chair, it should move accordingly. The chair's state includes its position, rotation, velocity, and angular velocity.
4. **Implement Object Interaction**: Allow the avatar to interact with the chair. This could include sitting on the chair or applying a force to it.
5. **Handle State Changes**: When the avatar interacts with the chair, update the states of both the avatar and the chair. This includes the position, rotation, velocity, and angular velocity of the chair if it has been moved.

```elixir
# Elixir Khepri
server.put(chair_path, %{position: new_position, rotation: new_rotation, velocity: new_velocity, angular_velocity: new_angular_velocity})
server.put(avatar_path, %{sitting: true, sitting_on: chair_id})
```

6. **Implement Event-Driven Logic**: Instead of updating the game state every tick, use signals in Godot to trigger updates when certain events occur. For example, when the avatar sits on the chair, emit a signal that triggers the state update.

```gdscript
# Godot GDScript
signal avatar_sits_on_chair

func _on_avatar_sits_on_chair():
    server.put(chair_path, %{position: new_position, rotation: new_rotation, velocity: new_velocity, angular_velocity: new_angular_velocity})
    server.put(avatar_path, %{sitting: true, sitting_on: chair_id})
```

7. **Set Up Networking**: Set up a client-server network model using Elixir. When the state changes occur, send them to the server. The server then updates the game state and sends it back to the client(s).
8. **Encode State Changes**: Before sending the state changes over the network, encode them. This will ensure efficient parsing and hash consistent representations.

```elixir
# Elixir Khepri
encoded_state = encode(%{position: new_position, rotation: new_rotation, velocity: new_velocity, angular_velocity: new_angular_velocity, sitting: true, sitting_on: chair_id})
server.put(encoded_state)
```

9. **Implement Mastership and Ownership**: Assign mastership and ownership roles for each object in the VR environment. The master will be responsible for simulating the physics of the objects, while the owner will control the objects' actions.
10. **Test the System**: Test the system by interacting with the chair in the VR environment. Check if the state changes, including those related to physics, are correctly sent to the server and synchronized across all clients.

This proof of concept will allow us to validate our approach and identify any potential issues early in the development process. Once this basic functionality is working, we can incrementally add more features, such as additional interactive objects and avatars, more complex physics interactions, and so on.

## References

Here are the updated references with the full URLs repeated for your convenience:

1. **VR Prototype**

   - Virtual Reality: Prototyping for VR
     - Full URL: [https://www.oreilly.com/library/view/virtual-reality/9781491922827/ch04.html](https://www.oreilly.com/library/view/virtual-reality/9781491922827/ch04.html)

2. **Physics**

   - Real-Time Physics Simulation Forum: Rigid Body Dynamics
     - Full URL: [https://pybullet.org/Bullet/phpBB3/viewforum.php?f=4&sid=cd32b8f8490e84932662a76461055563](https://pybullet.org/Bullet/phpBB3/viewforum.php?f=4&sid=cd32b8f8490e84932662a76461055563)
   - Godot Engine Documentation: Using Rigid Bodies
     - Full URL: [https://docs.godotengine.org/en/stable/tutorials/physics/rigid_bodies.html](https://docs.godotengine.org/en/stable/tutorials/physics/rigid_bodies.html)

3. **Event-Driven**

   - Game Programming Patterns: Event Queue
     - Full URL: [http://gameprogrammingpatterns.com/event-queue.html](http://gameprogrammingpatterns.com/event-queue.html)

4. **State Changes**

   - Gamasutra: Understanding State Machines
     - Full URL: [https://www.gamasutra.com/view/feature/132083/understanding_state_machines.php](https://www.gamasutra.com/view/feature/132083/understanding_state_machines.php)

5. **Mastership vs Ownership**

   - High Fidelity: Entity Ownership
     - Full URL: [https://docs.highfidelity.com/create-and-explore/entities/entity-ownership](https://docs.highfidelity.com/create-and-explore/entities/entity-ownership)

6. **Networking**

   - Godot Engine Documentation: High-level Multiplayer
     - Full URL: [https://docs.godotengine.org/en/stable/tutorials/networking/high_level_multiplayer.html](https://docs.godotengine.org/en/stable/tutorials/networking/high_level_multiplayer.html)
   - Elixir School: Basics of OTP Concurrency
     - Full URL: [https://elixirschool.com/en/lessons/advanced/otp-concurrency/](https://elixirschool.com/en/lessons/advanced/otp-concurrency/)

7. **Encode State Changes**

   - Elixir Guide: Working with JSON in Elixir
     - Full URL: [https://lobotuerto.com/blog/working-with-json-in-elixir/](https://lobotuerto.com/blog/working-with-json-in-elixir/)

8. **Test the System**

   - Godot Engine Documentation: Testing
     - Full URL: [https://docs.godotengine.org/en/stable/getting_started/workflow/testing/index.html](https://docs.godotengine.org/en/stable/getting_started/workflow/testing/index.html)

9. Serialization Strategies

   - Full URL: [https://gafferongames.com/post/serialization_strategies/](https://gafferongames.com/post/serialization_strategies/)

10. Networked Physics in Virtual Reality

    - Full URL: [https://www.youtube.com/watch?v=sx4IIQL0x7c](https://www.youtube.com/watch?v=sx4IIQL0x7c)

11. Godot Engine Proposal

    - Full URL: [https://github.com/godotengine/godot-proposals/issues/3375](https://github.com/godotengine/godot-proposals/issues/3375)

12. Host your Unreal Engine game for under $1 USD

    - Full URL: [https://aws.amazon.com/blogs/gametech/how-to-host-your-unreal-engine-game-for-under-1-per-player-with-amazon-gamelift/](https://aws.amazon.com/blogs/gametech/how-to-host-your-unreal-engine-game-for-under-1-per-player-with-amazon-gamelift/)
